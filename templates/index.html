<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Media Downloader API</title>
    <link rel="stylesheet" href="/static/style.css">
</head>
<body>
    <div class="container">
        <header>
            <h1>Media Downloader API</h1>
            <p class="subtitle">YouTube Audio, Video & TikTok Downloader</p>
        </header>

        <section class="api-section">
            <h2>API Endpoints</h2>
            
            <div class="endpoint-card">
                <div class="endpoint-header">
                    <span class="method get">GET/POST</span>
                    <code>/api/youtube/audio</code>
                </div>
                <p class="description">Download YouTube audio in selected quality (64kbps default)</p>
                <div class="params">
                    <strong>Parameters:</strong>
                    <ul>
                        <li><code>url</code> (required) - YouTube video URL</li>
                        <li><code>quality</code> (optional) - Audio quality: 64, 128, 192, 256, 320 (default 64)</li>
                    </ul>
                </div>
            </div>

            <div class="endpoint-card">
                <div class="endpoint-header">
                    <span class="method get">GET/POST</span>
                    <code>/api/youtube/video</code>
                </div>
                <p class="description">Download YouTube video in selected quality</p>
                <div class="params">
                    <strong>Parameters:</strong>
                    <ul>
                        <li><code>url</code> (required) - YouTube video URL</li>
                        <li><code>quality</code> (optional) - Video quality: 360, 720, best (default best)</li>
                    </ul>
                </div>
            </div>
        </section>

        <section class="test-section">
            <h2>Test API</h2>
            
            <div class="test-form">
                <h3>YouTube Downloader</h3>
                <input type="text" id="youtube-url" placeholder="Enter YouTube URL" value="https://youtu.be/Qo4IOTAbGAM?si=yvVvCQnX7eTLPsGx">
                
                <div class="options-group">
                    <div class="option">
                        <label for="audio-quality">Audio Quality:</label>
                        <select id="audio-quality">
                            <option value="64">64 kbps</option>
                            <option value="128">128 kbps</option>
                            <option value="192">192 kbps</option>
                            <option value="256">256 kbps</option>
                            <option value="320">320 kbps</option>
                        </select>
                    </div>
                    <div class="option">
                        <label for="video-quality">Video Quality:</label>
                        <select id="video-quality">
                            <option value="360">360p</option>
                            <option value="720">720p</option>
                            <option value="best" selected>Best Quality</option>
                        </select>
                    </div>
                </div>

                <div class="button-group">
                    <button onclick="downloadYouTubeAudio()">Download Audio (MP3)</button>
                    <button onclick="downloadYouTubeVideo()">Download Video</button>
                    <button onclick="getYouTubeInfo()">Get Info</button>
                </div>
            </div>

            <div class="test-form">
                <h3>TikTok Downloader</h3>
                <input type="text" id="tiktok-url" placeholder="Enter TikTok URL" value="https://vt.tiktok.com/ZSfwk7dhv/">
                <div class="button-group">
                    <button onclick="downloadTikTok()">Download Video</button>
                    <button onclick="getTikTokInfo()">Get Info</button>
                </div>
            </div>

            <div id="result" class="result"></div>
        </section>

        <footer>
            <p>Media Downloader API - Updated with high quality support</p>
        </footer>
    </div>

    <script>
        const BASE_URL = window.location.origin;

        function showResult(message, isError = false) {
            const result = document.getElementById('result');
            result.innerHTML = `<pre class="${isError ? 'error' : 'success'}">${JSON.stringify(message, null, 2)}</pre>`;
        }

        function showLoading() {
            const result = document.getElementById('result');
            result.innerHTML = '<p class="loading">Processing... Please wait.</p>';
        }

        async function downloadYouTubeAudio() {
            const url = document.getElementById('youtube-url').value;
            const quality = document.getElementById('audio-quality').value;
            if (!url) {
                showResult({error: 'Please enter a YouTube URL'}, true);
                return;
            }
            showLoading();
            window.location.href = `${BASE_URL}/api/youtube/audio?url=${encodeURIComponent(url)}&quality=${quality}`;
            showResult({message: 'Download started...'});
        }

        async function downloadYouTubeVideo() {
            const url = document.getElementById('youtube-url').value;
            const quality = document.getElementById('video-quality').value;
            if (!url) {
                showResult({error: 'Please enter a YouTube URL'}, true);
                return;
            }
            showLoading();
            window.location.href = `${BASE_URL}/api/youtube/video?url=${encodeURIComponent(url)}&quality=${quality}`;
            showResult({message: 'Download started...'});
        }

        async function getYouTubeInfo() {
            const url = document.getElementById('youtube-url').value;
            if (!url) {
                showResult({error: 'Please enter a YouTube URL'}, true);
                return;
            }
            showLoading();
            try {
                const response = await fetch(`${BASE_URL}/api/youtube/info?url=${encodeURIComponent(url)}`);
                const data = await response.json();
                showResult(data, !data.success);
            } catch (error) {
                showResult({error: error.message}, true);
            }
        }

        async function downloadTikTok() {
            const url = document.getElementById('tiktok-url').value;
            if (!url) {
                showResult({error: 'Please enter a TikTok URL'}, true);
                return;
            }
            showLoading();
            window.location.href = `${BASE_URL}/api/tiktok/download?url=${encodeURIComponent(url)}`;
            showResult({message: 'Download started...'});
        }

        async function getTikTokInfo() {
            const url = document.getElementById('tiktok-url').value;
            if (!url) {
                showResult({error: 'Please enter a TikTok URL'}, true);
                return;
            }
            showLoading();
            try {
                const response = await fetch(`${BASE_URL}/api/tiktok/info?url=${encodeURIComponent(url)}`);
                const data = await response.json();
                showResult(data, !data.success);
            } catch (error) {
                showResult({error: error.message}, true);
            }
        }
    </script>
</body>
</html>
