<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Media Downloader API</title>
    <link rel="stylesheet" href="/static/style.css">
</head>
<body>
    <div class="container">
        <header>
            <h1>Media Downloader API</h1>
            <p class="subtitle">YouTube Audio, Video & TikTok Downloader</p>
        </header>

        <section class="api-section">
            <h2>API Endpoints</h2>
            
            <div class="endpoint-card">
                <div class="endpoint-header">
                    <span class="method get">GET/POST</span>
                    <code>/api/youtube/audio</code>
                </div>
                <p class="description">Download YouTube audio in low quality MP3 format (64kbps)</p>
                <div class="params">
                    <strong>Parameters:</strong>
                    <ul>
                        <li><code>url</code> (required) - YouTube video URL</li>
                    </ul>
                </div>
                <div class="example">
                    <strong>Example:</strong>
                    <pre>GET /api/youtube/audio?url=https://youtu.be/VIDEO_ID</pre>
                    <pre>POST /api/youtube/audio
Content-Type: application/json
{"url": "https://youtu.be/VIDEO_ID"}</pre>
                </div>
            </div>

            <div class="endpoint-card">
                <div class="endpoint-header">
                    <span class="method get">GET/POST</span>
                    <code>/api/youtube/video</code>
                </div>
                <p class="description">Download YouTube video in 360p quality</p>
                <div class="params">
                    <strong>Parameters:</strong>
                    <ul>
                        <li><code>url</code> (required) - YouTube video URL</li>
                    </ul>
                </div>
                <div class="example">
                    <strong>Example:</strong>
                    <pre>GET /api/youtube/video?url=https://youtu.be/VIDEO_ID</pre>
                    <pre>POST /api/youtube/video
Content-Type: application/json
{"url": "https://youtu.be/VIDEO_ID"}</pre>
                </div>
            </div>

            <div class="endpoint-card">
                <div class="endpoint-header">
                    <span class="method get">GET/POST</span>
                    <code>/api/youtube/info</code>
                </div>
                <p class="description">Get YouTube video information without downloading</p>
                <div class="params">
                    <strong>Parameters:</strong>
                    <ul>
                        <li><code>url</code> (required) - YouTube video URL</li>
                    </ul>
                </div>
                <div class="example">
                    <strong>Response:</strong>
                    <pre>{
    "success": true,
    "title": "Video Title",
    "duration": 180,
    "thumbnail": "https://...",
    "uploader": "Channel Name",
    "view_count": 1000000
}</pre>
                </div>
            </div>

            <div class="endpoint-card">
                <div class="endpoint-header">
                    <span class="method get">GET/POST</span>
                    <code>/api/tiktok/download</code>
                </div>
                <p class="description">Download TikTok video</p>
                <div class="params">
                    <strong>Parameters:</strong>
                    <ul>
                        <li><code>url</code> (required) - TikTok video URL</li>
                    </ul>
                </div>
                <div class="example">
                    <strong>Example:</strong>
                    <pre>GET /api/tiktok/download?url=https://vt.tiktok.com/XXXXX</pre>
                    <pre>POST /api/tiktok/download
Content-Type: application/json
{"url": "https://vt.tiktok.com/XXXXX"}</pre>
                </div>
            </div>

            <div class="endpoint-card">
                <div class="endpoint-header">
                    <span class="method get">GET/POST</span>
                    <code>/api/tiktok/info</code>
                </div>
                <p class="description">Get TikTok video information without downloading</p>
                <div class="params">
                    <strong>Parameters:</strong>
                    <ul>
                        <li><code>url</code> (required) - TikTok video URL</li>
                    </ul>
                </div>
                <div class="example">
                    <strong>Response:</strong>
                    <pre>{
    "success": true,
    "title": "Video Title",
    "duration": 30,
    "thumbnail": "https://...",
    "uploader": "Username",
    "view_count": 500000
}</pre>
                </div>
            </div>

            <div class="endpoint-card">
                <div class="endpoint-header">
                    <span class="method get">GET</span>
                    <code>/health</code>
                </div>
                <p class="description">Health check endpoint</p>
                <div class="example">
                    <strong>Response:</strong>
                    <pre>{"status": "healthy", "message": "API is running"}</pre>
                </div>
            </div>
        </section>

        <section class="test-section">
            <h2>Test API</h2>
            
            <div class="test-form">
                <h3>YouTube Downloader</h3>
                <input type="text" id="youtube-url" placeholder="Enter YouTube URL" value="https://youtu.be/Qo4IOTAbGAM?si=h079uhTcmzZxsS28">
                <div class="button-group">
                    <button onclick="downloadYouTubeAudio()">Download Audio (MP3)</button>
                    <button onclick="downloadYouTubeVideo()">Download Video (360p)</button>
                    <button onclick="getYouTubeInfo()">Get Info</button>
                </div>
            </div>

            <div class="test-form">
                <h3>TikTok Downloader</h3>
                <input type="text" id="tiktok-url" placeholder="Enter TikTok URL" value="https://vt.tiktok.com/ZSfwk7dhv/">
                <div class="button-group">
                    <button onclick="downloadTikTok()">Download Video</button>
                    <button onclick="getTikTokInfo()">Get Info</button>
                </div>
            </div>

            <div id="result" class="result"></div>
        </section>

        <section class="deploy-section">
            <h2>Render Deployment</h2>
            <div class="deploy-info">
                <p>This API is ready for Render deployment. Required files:</p>
                <ul>
                    <li><code>requirements.txt</code> - Python dependencies</li>
                    <li><code>render.yaml</code> - Render configuration</li>
                </ul>
                <div class="deploy-steps">
                    <h4>Deployment Steps:</h4>
                    <ol>
                        <li>Push code to GitHub</li>
                        <li>Connect GitHub repo to Render</li>
                        <li>Select "Web Service"</li>
                        <li>Build Command: <code>pip install -r requirements.txt</code></li>
                        <li>Start Command: <code>gunicorn app:app --bind 0.0.0.0:$PORT</code></li>
                    </ol>
                </div>
            </div>
        </section>

        <footer>
            <p>Media Downloader API - For educational purposes only</p>
        </footer>
    </div>

    <script>
        const BASE_URL = window.location.origin;

        function showResult(message, isError = false) {
            const result = document.getElementById('result');
            result.innerHTML = `<pre class="${isError ? 'error' : 'success'}">${JSON.stringify(message, null, 2)}</pre>`;
        }

        function showLoading() {
            const result = document.getElementById('result');
            result.innerHTML = '<p class="loading">Processing... Please wait.</p>';
        }

        async function downloadYouTubeAudio() {
            const url = document.getElementById('youtube-url').value;
            if (!url) {
                showResult({error: 'Please enter a YouTube URL'}, true);
                return;
            }
            showLoading();
            window.location.href = `${BASE_URL}/api/youtube/audio?url=${encodeURIComponent(url)}`;
            showResult({message: 'Download started...'});
        }

        async function downloadYouTubeVideo() {
            const url = document.getElementById('youtube-url').value;
            if (!url) {
                showResult({error: 'Please enter a YouTube URL'}, true);
                return;
            }
            showLoading();
            window.location.href = `${BASE_URL}/api/youtube/video?url=${encodeURIComponent(url)}`;
            showResult({message: 'Download started...'});
        }

        async function getYouTubeInfo() {
            const url = document.getElementById('youtube-url').value;
            if (!url) {
                showResult({error: 'Please enter a YouTube URL'}, true);
                return;
            }
            showLoading();
            try {
                const response = await fetch(`${BASE_URL}/api/youtube/info?url=${encodeURIComponent(url)}`);
                const data = await response.json();
                showResult(data, !data.success);
            } catch (error) {
                showResult({error: error.message}, true);
            }
        }

        async function downloadTikTok() {
            const url = document.getElementById('tiktok-url').value;
            if (!url) {
                showResult({error: 'Please enter a TikTok URL'}, true);
                return;
            }
            showLoading();
            window.location.href = `${BASE_URL}/api/tiktok/download?url=${encodeURIComponent(url)}`;
            showResult({message: 'Download started...'});
        }

        async function getTikTokInfo() {
            const url = document.getElementById('tiktok-url').value;
            if (!url) {
                showResult({error: 'Please enter a TikTok URL'}, true);
                return;
            }
            showLoading();
            try {
                const response = await fetch(`${BASE_URL}/api/tiktok/info?url=${encodeURIComponent(url)}`);
                const data = await response.json();
                showResult(data, !data.success);
            } catch (error) {
                showResult({error: error.message}, true);
            }
        }
    </script>
</body>
</html>
